!function(){function a(a,b,c){var d=document.createElement("div"),e=document.createElement("img"),g=document.createElement("p");return e.src=k.lodingImg,k.loading(d),c?(d.appendChild(e),d.appendChild(g),b.insertBefore(d,a),d.style.top="0px"):(d.appendChild(g),d.appendChild(e),b.appendChild(d),d.style.bottom="0px"),f(d),d}function b(a){var b=a.querySelectorAll("p")[0],c=a.querySelectorAll("img")[0];a.style.display="block",c.style.visibility="visible",b.innerHTML="正在加载，请稍后"}function c(a){var b=a.querySelectorAll("p")[0],c=a.querySelectorAll("img")[0];c.src=k.succImg,b.innerHTML="加载成功!"}function d(a){var b=a.querySelectorAll("p")[0],c=a.querySelectorAll("img")[0];c.src=k.failImg,b.innerHTML="加载失败!"}function e(a){var b=a.querySelectorAll("p")[0],c=a.querySelectorAll("img")[0];c.src=k.succImg,b.innerHTML="没有更多了"}function f(a){var b=a.querySelectorAll("p")[0],c=a.querySelectorAll("img")[0];a.style.display="none",c.src=k.loadingImg,c.style.cssText="visibility:hidden;margin:0 auto",b.innerHTML="释放加载新内容"}function g(a,b){var c=function(){b(a),a.removeEventListener("webkitTransitionEnd",c,!1),a.removeEventListener("transitionend",c,!1)};a.addEventListener("webkitTransitionEnd",c,!1),a.addEventListener("transitionend",c,!1)}function h(a,b,c){if(i(a))return!1;var d=a.parentElement;if(!i(d)&&(d.tagName==b.toUpperCase()||d.className.indexOf(b)>-1)){if(console.log(d.parentElement!==c,d.parentElement),d.parentElement===c)return!1;h(d.parentElement,b,c)}else h(d,b,c)}function i(a){return"A"==a.tagName||a.onclick?void a.click():!1}var j=function(a){try{if(!(a.target&&a.insertf&&a.insert&&a.item))throw new Error("元素不齐全，无法运行！")}catch(b){return console.error(b.message),!1}this.target=document.querySelector(a.target),this.insertf=document.querySelector(a.insertf),this.insert=this.insertf.querySelectorAll(a.insert)[0],this.item=a.item,this.headrelease=a.headrelease||function(){},this.footrelease=a.footrelease||function(){},this.headonly=a.headonly||0,this.footonly=a.footonly||0,this.drag={},this.pos=0,this.init(),this.events(),this.dragable=1},k={stage:function(a){a.style.cssText+="position: relative;overflow: hidden;"},insertf:function(a){a.style.cssText="-webkit-transition: all 1s;-moz-transition:all 1s;transition:all 1s;position: absolute;top:0px;left:0px;z-index:9;overflow-y: scroll;-webkit-overflow-scrolling: touch;"},loading:function(a){a.style.cssText="text-align:center;padding:8px 0;width:100%;position:absolute;z-index:1;left:0px;display:none;-webkit-transition: all 1s;-moz-transition:all 1s;transition:all 1s;"},loadingImg:"data:image/gif;base64,R0lGODlhEAAQALMPAHp6evf394qKiry8vJOTk83NzYKCgubm5t7e3qysrMXFxe7u7pubm7S0tKOjo////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCAAPACwAAAAAEAAQAAAETPDJSau9NRDAgWxDYGmdZADCkQnlU7CCOA3oNgXsQG2FRhUAAoWDIU6MGeSDR0m4ghRa7JjIUXCogqQzpRxYhi2HILsOGuJxGcNuTyIAIfkECQgADwAsAAAAABAAEAAABGLwSXmMmjhLAQjSWDAYQHmAz8GVQPIESxZwggIYS0AIATYAvAdh8OIQJwRAQbJkdjAlUCA6KfU0VEmyGWgWnpNfcEAoAo6SmWtBUtCuk9gjwQKeQAeWYQAHIZICKBoKBncTEQAh+QQJCAAPACwAAAAAEAAQAAAEWvDJORejGCtQsgwDAQAGGWSHMK7jgAWq0CGj0VEDIJxPnvAU0a13eAQKrsnI81gqAZ6AUzIonA7JRwFAyAQSgCQsjCmUAIhjDEhlrQTFV+lMGLApWwUzw1jsIwAh+QQJCAAPACwAAAAAEAAQAAAETvDJSau9L4QaBgEAMWgEQh0CqALCZ0pBKhRSkYLvM7Ab/OGThoE2+QExyAdiuexhVglKwdCgqKKTGGBgBc00Np7VcVsJDpVo5ydyJt/wCAAh+QQJCAAPACwAAAAAEAAQAAAEWvDJSau9OAwCABnBtQhdCQjHlQhFWJBCOKWPLAXk8KQIkCwWBcAgMDw4Q5CkgOwohCVCYTIwdAgPolVhWSQAiN1jcLLVQrQbrBV4EcySA8l0Alo0yA8cw+9TIgAh+QQFCAAPACwAAAAAEAAQAAAEWvDJSau9WA4AyAhWMChPwXHCQRUGYARgKQBCzJxAQgXzIC2KFkc1MREoHMTAhwQ0Y5oBgkMhAAqUw8mgWGho0EcCx5DwaAUQrGXATg6zE7bwCQ2sAGZmz7dEAAA7",succImg:"data:image/gif;base64,R0lGODlhEAAQALMAAACZAF+/X8/szx6lHp/Zn4/SjxCfEO/576/frzCsMJTWlP///wAAAAAAAAAAAAAAACH5BAEHAAsALAAAAAAQABAAAAQ1cMlJq704ayoG2otgAAY4GgJ1WAkAfFOXTi1AVCdc3xUxAoUdRuRyFTREQAB0SCxB0KhUEgEAOw==",failImg:"data:image/gif;base64,R0lGODlhEAAQALMAAP8AAP+vr/9fX/8YGP+fn//f3/+Pj/8PD//MzP8zM/+/v/8JCf8fH////wAAAAAAACH5BAEHAA0ALAAAAAAQABAAAARDsMlJq704W0EqEVZxAMGkAEdhISjSIKN7EQBTMECXGcACGBoJjhFs8AY/DS1RSOQwsFRDdJBRqNao6spQVBS2olgTAQA7"};j.prototype.fix=function(){var a=this;a.items=a.target.querySelectorAll(a.item),a.first=a.items[0],a.last=a.items[a.items.length-1],a.pos=0,a.drag={},a.dragable=1,a.firstTime=0,a.fail=0,a.insertf.style.top="0px",f(a.fLoading),f(a.lLoading)},j.prototype.init=function(){var b=this;k.stage(b.target),k.insertf(b.insertf),b.fLoading=a(b.insertf,b.target,1),b.lLoading=a(b.insertf,b.target,0),b.fix()},j.prototype.events=function(){var a=this;a.insertf.addEventListener("touchstart",function(b){if(1!=a.dragable)return!1;var c=a.insert.clientHeight-a.insertf.clientHeight;if(0==a.insertf.scrollTop||a.insertf.scrollTop==c){b.preventDefault();var d=new Date;if(a.firstTime=0==c?1:2,a.pos=a.insertf.scrollTop==c?1:0,a.drag={y:b.targetTouches[0].pageY,t:d.getTime()},a.headonly&&a.insertf.scrollTop==c)return!1;if(a.footonly&&0==a.insertf.scrollTop)return!1;a.dragable=2}},!1),a.insertf.addEventListener("touchmove",function(b){if(!a.drag.y||2!=a.dragable)return!1;if(a.drag.ca=b.targetTouches[0].pageY-a.drag.y,1==a.firstTime)b.preventDefault(),a.pos=a.drag.ca<0?1:0,0==a.firstTime;else if(2==a.firstTime){if(!(a.drag.ca>0&&0==a.pos||a.drag.ca<0&&1==a.pos))return a.insertf.scrollTop-=.5*a.drag.ca,!1;b.preventDefault()}if(a.pos){if(a.headonly)return!1;a.lLoading.style.display="block",a.insertf.style.top="-96px"}else a.fLoading.style.display="block",a.insertf.style.top="96px"},!1),a.insertf.addEventListener("touchend",function(f){var i=new Date;if(2==a.firstTime&&(a.drag.ca>0&&0==a.pos||a.drag.ca<0&&1==a.pos?f.preventDefault():a.fail=1),a.drag.y&&2==a.dragable){if(f.preventDefault(),a.dragable=3,a.fail||i.getTime()-a.drag.t<280)return h(f.target,a.item,a.insert),a.fix(),!1;if(a.pos){if(a.headonly)return!1;a.insertf.style.top="-70px",b(a.lLoading);var j=function(){a.insertf.style.top="0px",a.insertf.scrollTop=a.insert.clientHeight-a.insertf.clientHeight,g(a.insertf,function(){a.fix()})};setTimeout(function(){a.footrelease({success:function(b){c(a.lLoading),setTimeout(function(){a.insert.innerHTML=a.insert.innerHTML+b,j()},800)},fail:function(){d(a.lLoading),setTimeout(function(){j()},800)},none:function(){e(a.lLoading),setTimeout(function(){j()},800)}})},1e3)}else{if(a.footonly)return;a.insertf.style.top="70px",b(a.fLoading);var j=function(){a.insertf.scrollTop=0,a.insertf.style.top="0px",g(a.insertf,function(){a.fix()})};setTimeout(function(){a.headrelease({success:function(b){c(a.fLoading),setTimeout(function(){a.insert.innerHTML=b+a.insert.innerHTML,j()},800)},fail:function(){d(a.fLoading),setTimeout(function(){j()},800)},none:function(){e(a.fLoading),setTimeout(function(){j()},800)}})},1e3)}}else if(3!=a.dragable)return void a.fix()},!1)},window.HoldReflash=j}();
